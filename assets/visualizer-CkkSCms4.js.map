{"version":3,"file":"visualizer-CkkSCms4.js","sources":["../../src/utils/visualizer.jsx"],"sourcesContent":["import React, {\n  Fragment,\n  createContext,\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nimport \"./visualizer.css\";\n\nconst VisualizerContext = createContext({ gravity: \"top\", scale: 1 });\n\nexport function Canvas({ gravity, scale, children }) {\n  const [width, setWidth] = useState(0);\n  const [height, setHeight] = useState(0);\n\n  return (\n    <VisualizerContext.Provider\n      value={{ gravity: gravity ?? \"top\", scale: scale ?? 1, setWidth, setHeight }}>\n      <div\n        className=\"relative m-8 w-full\"\n        style={{ width: width + 32, height: height + 32 }}>\n        {children}\n      </div>\n    </VisualizerContext.Provider>\n  );\n}\n\nexport function Sprite({ src, alt, x, y, width, height, rotation, follow, className }) {\n  x ??= 0;\n  y ??= 0;\n  rotation ??= 0;\n  width ??= 1;\n  height ??= 1;\n\n  const ref = useRef();\n\n  const pos = useRef({ x, y, changed: false });\n  useEffect(() => {\n    if (x !== pos.current.x || y !== pos.current.y) {\n      pos.current = { x, y, changed: true };\n    }\n  }, [pos.current, x, y]);\n\n  const { gravity, scale, setWidth, setHeight } = useContext(VisualizerContext);\n  useLayoutEffect(() => {\n    const box = ref.current?.getBoundingClientRect();\n\n    const scaleX = (width - 1) * 0.5 + 1;\n    const scaleY = (height - 1) * 0.5 + 1;\n\n    setTimeout(() => {\n      setWidth((w) => Math.max(w, x * scale + (box ? box.width / width : src.width) * scaleX));\n      setHeight((h) => Math.max(h, y * scale + (box ? box.height / height : src.height) * scaleY));\n    }, 5);\n\n    if (!pos.current.changed || !follow) return;\n    const id = setTimeout(() => {\n      return ref.current?.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"nearest\",\n        inline: \"center\",\n      });\n    }, 160);\n    return () => clearTimeout(id);\n  }, [ref.current, pos.current, x, y]);\n\n  return (\n    <img\n      ref={ref}\n      alt={alt}\n      {...src}\n      className={`absolute transition-all ${className ?? \"\"}`}\n      style={{\n        [gravity]: `${y * scale}px`,\n        left: `${x * scale}px`,\n        transform: `rotate(${rotation}turn) scaleX(${width}) scaleY(${height})`,\n      }}\n    />\n  );\n}\n\nexport function Rectangle({ color, border_color, height, width, x, y, rotation, className, style, children }) {\n  x ??= 0;\n  y ??= 0;\n  rotation ??= 0;\n  style ??= {};\n  color ??= \"white\";\n  border_color ??= \"black\";\n\n  const ref = useRef();\n  const { gravity, scale, setWidth, setHeight } = useContext(VisualizerContext);\n\n  useEffect(() => {\n    const box = ref.current?.getBoundingClientRect();\n    setTimeout(() => {\n      setWidth((w) => Math.max(w, x * scale + (box?.width ?? width)));\n      setHeight((h) => Math.max(h, y * scale + (box?.height ?? height)));\n    }, 5);\n  }, [x, y, width, height]);\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        backgroundColor: color,\n        borderColor: border_color,\n        height: `${height * scale}px`,\n        width: `${width * scale}px`,\n        left: `${x * scale}px`,\n        [gravity]: `${y * scale}px`,\n        transform: `rotate(${rotation}turn)`,\n        ...style\n      }}\n      className={`absolute border-2 border-solid transition-all ${className ?? \"\"}`}>\n      {children}\n    </div>\n  );\n}\n\nexport function Variables({ variables }) {\n  return (\n    <div className=\"m-4 grid max-w-sm grid-cols-2 gap-y-2 text-slate-950 *:bg-orange-400 *:px-4 *:py-1.5\">\n      {Object.entries(variables).map(([name, value]) => (\n        <Fragment key={name}>\n          <div className=\"rounded-l-2xl\">{name}</div>\n          <div className=\"rounded-r-2xl\">\n            <div className=\"rounded-lg bg-white px-2\">{value == null ? \"-\" : value}</div>\n          </div>\n        </Fragment>\n      ))}\n    </div>\n  );\n}\n"],"names":["VisualizerContext","createContext","gravity","scale","Canvas","children","width","setWidth","useState","height","setHeight","_jsx","Provider","value","div","className","style","Sprite","src","alt","x","y","rotation","follow","ref","useRef","pos","changed","useEffect","current","useContext","useLayoutEffect","box","getBoundingClientRect","scaleX","scaleY","setTimeout","w","Math","max","h","id","scrollIntoView","behavior","block","inline","clearTimeout","img","left","transform","Rectangle","color","border_color","backgroundColor","borderColor","Variables","variables","Object","entries","map","name","_jsxs","Fragment"],"mappings":"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"}