{"version":3,"file":"visualizer-BXXEsLHC.js","sources":["../../src/utils/visualizer.jsx"],"sourcesContent":["import React, {\n  Fragment,\n  createContext,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nimport \"./visualizer.css\";\n\nconst VisualizerContext = createContext({ gravity: \"top\", scale: 1 });\n\nexport function Canvas({ gravity, scale, children }) {\n  const [width, setWidth] = useState(0);\n  const [height, setHeight] = useState(0);\n\n  return (\n    <VisualizerContext.Provider\n      value={{ gravity: gravity ?? \"top\", scale: scale ?? 1, setWidth, setHeight }}>\n      <div\n        className=\"relative m-8 w-full\"\n        style={{ width: width + 32, height: height + 32 }}>\n        {children}\n      </div>\n    </VisualizerContext.Provider>\n  );\n}\n\nexport function Sprite({ src, alt, x, y, width, height, rotation, follow, className }) {\n  x ??= 0;\n  y ??= 0;\n  rotation ??= 0;\n  width ??= 1;\n  height ??= 1;\n\n  const ref = useRef();\n\n  const pos = useRef({ x, y, changed: false });\n  useEffect(() => {\n    if (x !== pos.current.x || y !== pos.current.y) {\n      pos.current = { x, y, changed: true };\n    }\n  }, [pos.current, x, y]);\n\n  const { gravity, scale, setWidth, setHeight } = useContext(VisualizerContext);\n  useEffect(() => {\n    const box = ref.current?.getBoundingClientRect();\n\n    setTimeout(() => {\n      setWidth((w) => Math.max(w, x * scale + (box?.width ?? src.width*width)));\n      setHeight((h) => Math.max(h, y * scale + (box?.height ?? src.height*height)));\n    }, 5);\n\n    if (!pos.current.changed || !follow) return;\n    const id = setTimeout(() => {\n      return ref.current?.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"nearest\",\n        inline: \"center\",\n      });\n    }, 160);\n    return () => clearTimeout(id);\n  }, [ref.current, pos.current, x, y]);\n\n  return (\n    <img\n      ref={ref}\n      alt={alt}\n      {...src}\n      className={`absolute transition-all ${className ?? \"\"}`}\n      style={{\n        [gravity]: `${y * scale}px`,\n        left: `${x * scale}px`,\n        transform: `rotate(${rotation}turn) scaleX(${width}) scaleY(${height})`,\n      }}\n    />\n  );\n}\n\nexport function Rectangle({ color, height, width, x, y, rotation, className, style, children }) {\n  x ??= 0;\n  y ??= 0;\n  rotation ??= 0;\n  style ??= {};\n\n  const ref = useRef();\n  const { gravity, scale, setWidth, setHeight } = useContext(VisualizerContext);\n\n  useEffect(() => {\n    const box = ref.current?.getBoundingClientRect();\n    setTimeout(() => {\n      setWidth((w) => Math.max(w, x * scale + (box?.width ?? width)));\n      setHeight((h) => Math.max(h, y * scale + (box?.height ?? height)));\n    }, 5);\n  }, [x, y, width, height]);\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        backgroundColor: color,\n        height: `${height * scale}px`,\n        width: `${width * scale}px`,\n        left: `${x * scale}px`,\n        [gravity]: `${y * scale}px`,\n        transform: `rotate(${rotation}turn)`,\n        ...style\n      }}\n      className={`absolute border-2 border-solid border-black transition-all ${className ?? \"\"}`}>\n      {children}\n    </div>\n  );\n}\n\nexport function Variables({ variables }) {\n  return (\n    <div className=\"m-4 grid max-w-sm grid-cols-2 gap-y-2 text-slate-950 *:bg-orange-400 *:px-4 *:py-1.5\">\n      {Object.entries(variables).map(([name, value]) => (\n        <Fragment key={name}>\n          <div className=\"rounded-l-2xl\">{name}</div>\n          <div className=\"rounded-r-2xl\">\n            <div className=\"rounded-lg bg-white px-2\">{value == null ? \"-\" : value}</div>\n          </div>\n        </Fragment>\n      ))}\n    </div>\n  );\n}\n"],"names":["VisualizerContext","createContext","gravity","scale","Canvas","children","width","setWidth","useState","height","setHeight","_jsx","Provider","value","div","className","style","Sprite","src","alt","x","y","rotation","follow","ref","useRef","pos","changed","useEffect","current","useContext","box","getBoundingClientRect","setTimeout","w","Math","max","h","id","scrollIntoView","behavior","block","inline","clearTimeout","img","left","transform","Rectangle","color","backgroundColor","Variables","variables","Object","entries","map","name","_jsxs","Fragment"],"mappings":"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"}