/*! For licenses information, see LICENSES.txt */
const V=function(t){const e=[];let r=0;for(let a=0;a<t.length;a++){let n=t.charCodeAt(a);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=n&63|128):(n&64512)===55296&&a+1<t.length&&(t.charCodeAt(a+1)&64512)===56320?(n=65536+((n&1023)<<10)+(t.charCodeAt(++a)&1023),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=n&63|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=n&63|128)}return e},Y=function(t){const e=[];let r=0,a=0;for(;r<t.length;){const n=t[r++];if(n<128)e[a++]=String.fromCharCode(n);else if(n>191&&n<224){const s=t[r++];e[a++]=String.fromCharCode((n&31)<<6|s&63)}else if(n>239&&n<365){const s=t[r++],o=t[r++],c=t[r++],h=((n&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[a++]=String.fromCharCode(55296+(h>>10)),e[a++]=String.fromCharCode(56320+(h&1023))}else{const s=t[r++],o=t[r++];e[a++]=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63)}}return e.join("")},J={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let n=0;n<t.length;n+=3){const s=t[n],o=n+1<t.length,c=o?t[n+1]:0,h=n+2<t.length,l=h?t[n+2]:0,M=s>>2,u=(s&3)<<4|c>>4;let g=(c&15)<<2|l>>6,m=l&63;h||(m=64,o||(g=64)),a.push(r[M],r[u],r[g],r[m])}return a.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(V(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Y(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let n=0;n<t.length;){const s=r[t.charAt(n++)],c=n<t.length?r[t.charAt(n)]:0;++n;const l=n<t.length?r[t.charAt(n)]:64;++n;const u=n<t.length?r[t.charAt(n)]:64;if(++n,s==null||c==null||l==null||u==null)throw new X;const g=s<<2|c>>4;if(a.push(g),l!==64){const m=c<<4&240|l>>2;if(a.push(m),u!==64){const K=l<<6&192|u;a.push(K)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class X extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Z=function(t){const e=V(t);return J.encodeByteArray(e,!0)},F=function(t){return Z(t).replace(/\./g,"")};function z(){try{return typeof indexedDB=="object"}catch{return!1}}function Q(){return new Promise((t,e)=>{try{let r=!0;const a="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(a);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(a),t(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var s;e(((s=n.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}const q="FirebaseError";class b extends Error{constructor(e,r,a){super(r),this.code=e,this.customData=a,this.name=q,Object.setPrototypeOf(this,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,W.prototype.create)}}class W{constructor(e,r,a){this.service=e,this.serviceName=r,this.errors=a}create(e,...r){const a=r[0]||{},n=`${this.service}/${e}`,s=this.errors[e],o=s?ee(s,a):"Error",c=`${this.serviceName}: ${o} (${n}).`;return new b(n,c,a)}}function ee(t,e){return t.replace(te,(r,a)=>{const n=e[a];return n!=null?String(n):`<${a}?>`})}const te=/\{\$([^}]+)}/g;class D{constructor(e,r,a){this.name=e,this.instanceFactory=r,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}var i;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(i||(i={}));const re={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},ne=i.INFO,ae={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},se=(t,e,...r)=>{if(e<t.logLevel)return;const a=new Date().toISOString(),n=ae[e];if(n)console[n](`[${a}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oe{constructor(e){this.name=e,this._logLevel=ne,this._logHandler=se,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?re[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}const ie=(t,e)=>e.some(r=>t instanceof r);let O,R;function ce(){return O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function he(){return R||(R=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j=new WeakMap,w=new WeakMap,U=new WeakMap,E=new WeakMap,v=new WeakMap;function le(t){const e=new Promise((r,a)=>{const n=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(d(t.result)),n()},o=()=>{a(t.error),n()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&j.set(r,t)}).catch(()=>{}),v.set(e,t),e}function de(t){if(w.has(t))return;const e=new Promise((r,a)=>{const n=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),n()},o=()=>{a(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});w.set(t,e)}let C={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return w.get(t);if(e==="objectStoreNames")return t.objectStoreNames||U.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return d(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fe(t){C=t(C)}function ue(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const a=t.call(_(this),e,...r);return U.set(a,e.sort?e.sort():[e]),d(a)}:he().includes(t)?function(...e){return t.apply(_(this),e),d(j.get(this))}:function(...e){return d(t.apply(_(this),e))}}function pe(t){return typeof t=="function"?ue(t):(t instanceof IDBTransaction&&de(t),ie(t,ce())?new Proxy(t,C):t)}function d(t){if(t instanceof IDBRequest)return le(t);if(E.has(t))return E.get(t);const e=pe(t);return e!==t&&(E.set(t,e),v.set(e,t)),e}const _=t=>v.get(t);function be(t,e,{blocked:r,upgrade:a,blocking:n,terminated:s}={}){const o=indexedDB.open(t,e),c=d(o);return a&&o.addEventListener("upgradeneeded",h=>{a(d(o.result),h.oldVersion,h.newVersion,d(o.transaction),h)}),r&&o.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),c.then(h=>{s&&h.addEventListener("close",()=>s()),n&&h.addEventListener("versionchange",l=>n(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const ge=["get","getKey","getAll","getAllKeys","count"],me=["put","add","delete","clear"],y=new Map;function $(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(y.get(e))return y.get(e);const r=e.replace(/FromIndex$/,""),a=e!==r,n=me.includes(r);if(!(r in(a?IDBIndex:IDBObjectStore).prototype)||!(n||ge.includes(r)))return;const s=async function(o,...c){const h=this.transaction(o,n?"readwrite":"readonly");let l=h.store;return a&&(l=l.index(c.shift())),(await Promise.all([l[r](...c),n&&h.done]))[0]};return y.set(e,s),s}fe(t=>({...t,get:(e,r,a)=>$(e,r)||t.get(e,r,a),has:(e,r)=>!!$(e,r)||t.has(e,r)}));class Ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(_e(r)){const a=r.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(r=>r).join(" ")}}function _e(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const I="@firebase/app",N="0.9.29";const f=new oe("@firebase/app"),ye="@firebase/app-compat",Be="@firebase/analytics-compat",Se="@firebase/analytics",De="@firebase/app-check-compat",we="@firebase/app-check",Ce="@firebase/auth",Ie="@firebase/auth-compat",Ae="@firebase/database",ve="@firebase/database-compat",Te="@firebase/functions",Me="@firebase/functions-compat",Oe="@firebase/installations",Re="@firebase/installations-compat",$e="@firebase/messaging",Ne="@firebase/messaging-compat",He="@firebase/performance",Le="@firebase/performance-compat",Pe="@firebase/remote-config",xe="@firebase/remote-config-compat",Ve="@firebase/storage",Fe="@firebase/storage-compat",We="@firebase/firestore",je="@firebase/firestore-compat",Ue="firebase",ke={[I]:"fire-core",[ye]:"fire-core-compat",[Se]:"fire-analytics",[Be]:"fire-analytics-compat",[we]:"fire-app-check",[De]:"fire-app-check-compat",[Ce]:"fire-auth",[Ie]:"fire-auth-compat",[Ae]:"fire-rtdb",[ve]:"fire-rtdb-compat",[Te]:"fire-fn",[Me]:"fire-fn-compat",[Oe]:"fire-iid",[Re]:"fire-iid-compat",[$e]:"fire-fcm",[Ne]:"fire-fcm-compat",[He]:"fire-perf",[Le]:"fire-perf-compat",[Pe]:"fire-rc",[xe]:"fire-rc-compat",[Ve]:"fire-gcs",[Fe]:"fire-gcs-compat",[We]:"fire-fst",[je]:"fire-fst-compat","fire-js":"fire-js",[Ue]:"fire-js-all"};const Ge=new Map,H=new Map;function Ke(t,e){try{t.container.addComponent(e)}catch(r){f.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function A(t){const e=t.name;if(H.has(e))return f.debug(`There were multiple attempts to register component ${e}.`),!1;H.set(e,t);for(const r of Ge.values())Ke(r,t);return!0}const Ye={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},T=new W("app","Firebase",Ye);function B(t,e,r){var a;let n=(a=ke[t])!==null&&a!==void 0?a:t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const c=[`Unable to register library "${n}" with version "${e}":`];s&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),f.warn(c.join(" "));return}A(new D(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const Je="firebase-heartbeat-database",Xe=1,p="firebase-heartbeat-store";let S=null;function k(){return S||(S=be(Je,Xe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(p)}catch(r){console.warn(r)}}}}).catch(t=>{throw T.create("idb-open",{originalErrorMessage:t.message})})),S}async function Ze(t){try{const r=(await k()).transaction(p),a=await r.objectStore(p).get(G(t));return await r.done,a}catch(e){if(e instanceof b)f.warn(e.message);else{const r=T.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});f.warn(r.message)}}}async function L(t,e){try{const a=(await k()).transaction(p,"readwrite");await a.objectStore(p).put(e,G(t)),await a.done}catch(r){if(r instanceof b)f.warn(r.message);else{const a=T.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});f.warn(a.message)}}}function G(t){return`${t.name}!${t.options.appId}`}const ze=1024,Qe=30*24*60*60*1e3;class qe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new tt(r),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,r;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=P();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=Qe}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=P(),{heartbeatsToSend:a,unsentEntries:n}=et(this._heartbeatsCache.heartbeats),s=F(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=r,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function P(){return new Date().toISOString().substring(0,10)}function et(t,e=ze){const r=[];let a=t.slice();for(const n of t){const s=r.find(o=>o.agent===n.agent);if(s){if(s.dates.push(n.date),x(r)>e){s.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),x(r)>e){r.pop();break}a=a.slice(1)}return{heartbeatsToSend:r,unsentEntries:a}}class tt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return z()?Q().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ze(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return L(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return L(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function x(t){return F(JSON.stringify({version:2,heartbeats:t})).length}function rt(t){A(new D("platform-logger",e=>new Ee(e),"PRIVATE")),A(new D("heartbeat",e=>new qe(e),"PRIVATE")),B(I,N,t),B(I,N,"esm2017"),B("fire-js","")}rt("");export{b as F,B as r};
//# sourceMappingURL=firebase-B0BkmIJo.js.map
