import _ from "lodash";

export function buildVariant(i, weights) {
    const sortedWeights = _.sortBy(weights);

    const ans1 = _(sortedWeights).slice(4).sum();
    const ans2 = 2022 + _(sortedWeights).slice(0, 4).sum() - ans1;

    return {
        variant: i,
        weights,
        w: _.reverse(sortedWeights),
        ans1,
        ans2,
        sumWeights: _.sum(weights),
        diff: 2 * ans1 - _.sum(weights),
    };
}

export const variants = [
    buildVariant(0, [12, 27, 42, 27, 35, 30, 16, 50, 5]),
    buildVariant(1, [23, 10, 31, 8, 41, 31, 38, 29, 60]),
    buildVariant(2, [9, 25, 45, 11, 25, 59, 37, 20, 51])
];

Hai comprato $9$ barrette di cioccolato, i cui pesi (in una certa unità di misura) sono i seguenti:

$$
\js{weights.map(w => w.toString()).join(", \\; ")}
$$

Come premio per il tuo acquisto ingente, ti è stata offerta in regalo una maxi barretta di peso $2022$ (nella stessa unità di misura).

Vuoi distribuire le $10$ barrette in due scatole, in modo che ci siano **esattamente** $5$ barrette per scatola. Poi darai una scatola a tuo fratello e terrai l'altra per te. Sai che tuo fratello sceglierà sicuramente la scatola con barrette di peso totale maggiore (se i pesi delle due scatole sono uguali, ne sceglie una qualunque).
Ovviamente, vorresti tenere per te il **massimo peso** possibile.

1. Se scegli la distribuzione migliore, qual è il peso totale delle barrette di cioccolato nella **scatola che resta a te**?

?> {ans1}

> La risposta è $\js{ans1}$.
> 
> La maxi barretta ha un peso chiaramente superiore alla somma degli altri $9$.
> Quindi, qualunque sia la distribuzione delle barrette nelle scatole, tuo fratello sceglierà sempre la scatola che contiene la maxi barretta e a te rimarrà l'altra.
> 
> La distribuzione più conveniente è allora quella che massimizza il peso nella scatola che non contiene la maxi barretta:
> in particolare, conviene mettere in tale scatola le $5$ barrette (normali) più pesanti, cioè quelle di pesi $\js{w[0]}$, $\js{w[1]}$, $\js{w[2]}$, $\js{w[3]}$ e $\js{w[4]}$.
> La loro somma è $\js{ans1}$.
> 
> ![Statistiche risposte]({variant}-0.svg)

---

Tuttavia, prima di distribuire le barrette ti viene voglia di cioccolato, e decidi di mangiare un pezzo della maxi barretta di peso $2022$. Per non destare sospetti, vuoi che la risposta alla domanda 1 rimanga la stessa anche dopo aver mangiato parte della maxi barretta.

1. Qual è il **massimo peso** di un pezzo di maxi barretta che puoi mangiare senza che la risposta alla domanda precedente cambi?

?> {ans2}

> La risposta è $\js{ans2}$.
> 
> Se la scatola che ti rimane ha peso $\js{ans1}$, quella che prende tuo fratello deve avere almeno lo stesso peso, e pertanto la somma totale dei pesi delle barrette (compresa la maxi barretta parzialmente mangiata) deve essere maggiore o uguale di $2 \cdot \js{ans1} = \js{2 * ans1}$.
> Sottraendo a tale quantità la somma dei pesi delle $9$ barrette normali, si ottiene che il peso finale della maxi barretta deve essere almeno $\js{2 * ans1} - \js{sumWeights} = \js{diff}$.
> 
> D'altra parte, se la maxi barretta ha peso esattamente $\js{diff}$, possiamo suddividere le barrette esattamente come nella parte precedente, ovvero mettendo le $5$ barrette **normali** più pesanti in una scatola, e le altre nell'altra scatola.
> Così facendo, le due scatole hanno lo stesso peso di $\js{ans1}$, e quindi la risposta non cambia.
> 
> Pertanto il peso massimo che puoi mangiare è $2022 - \js{diff} = \js{ans2}$.
> 
> ![Statistiche risposte]({variant}-1.svg)
